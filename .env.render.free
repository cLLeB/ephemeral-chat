# Optimized Configuration for Render Free Tier
# Copy this to .env for local development
# Set these as Environment Variables in Render dashboard for production

# ============================================
# SERVER SETTINGS
# ============================================

PORT=3001
NODE_ENV=production

# Base URL - Update this with your Render URL after deployment
# Format: https://your-app-name.onrender.com
BASE_URL=https://ephemeral-chat-7j66.onrender.com

# ============================================
# SECURITY SETTINGS (Optimized for Free Tier)
# ============================================

# Inactivity Timeout
# Free tier: Use 10-15 minutes to reduce memory usage
# Shorter timeout = less memory consumption
INACTIVITY_TIMEOUT_MINUTES=10

# Failed Authentication Attempts
# Keep default for security
MAX_FAILED_ATTEMPTS=5

# Account Lockout Duration
# Free tier: Use 10 minutes (shorter to free up memory faster)
LOCKOUT_DURATION_MINUTES=10

# Room Code Salt
# IMPORTANT: Generate a unique value for production
# Run: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
ROOM_CODE_SALT=3b6f738f616078eb9d979604872d5b9899f4617282ecae0ca7b7ad1c49a63b9b

# ============================================
# ROOM SETTINGS (Optimized for Free Tier)
# ============================================

# Room Expiry
# Free tier: Use 60-90 minutes to reduce memory usage
# Shorter expiry = less memory consumption
ROOM_EXPIRY_MINUTES=60

# Invite Token Expiry
# Keep short for security and memory efficiency
INVITE_TOKEN_EXPIRY_MINUTES=5

# ============================================
# REDIS CONFIGURATION
# ============================================

# For Render Free Tier: Leave empty (use in-memory storage)
# Redis requires paid tier or external service
# REDIS_URL=

# ============================================
# RATE LIMITING (Optimized for Free Tier)
# ============================================

# Reduce limits to prevent abuse on free tier
MAX_MESSAGES_PER_MINUTE=20
RATE_LIMIT_WINDOW_MS=60000

# ============================================
# LOGGING
# ============================================

# Use 'info' level for production
LOG_LEVEL=info

# Enable security logging (minimal overhead)
ENABLE_SECURITY_LOGGING=true

# ============================================
# RENDER FREE TIER OPTIMIZATIONS
# ============================================

# These settings help manage the 512MB RAM limit on free tier

# 1. Shorter timeouts reduce memory usage
# 2. Shorter room expiry reduces stored data
# 3. No Redis = no external dependencies
# 4. Lower rate limits prevent memory spikes

# ============================================
# IMPORTANT NOTES FOR RENDER FREE TIER
# ============================================

# 1. Free tier has 512MB RAM limit
# 2. Service spins down after 15 minutes of inactivity
# 3. First request after spin-down takes ~30 seconds
# 4. No persistent storage (in-memory only)
# 5. Automatic HTTPS provided by Render

# ============================================
# DEPLOYMENT CHECKLIST
# ============================================

# [ ] Generate and set ROOM_CODE_SALT
# [ ] Update BASE_URL with your Render URL
# [ ] Set all variables in Render dashboard
# [ ] Enable "Auto-Deploy" for main branch
# [ ] Monitor memory usage in Render dashboard
# [ ] Test inactivity timeout works correctly
# [ ] Verify security features are active

# ============================================
# RENDER ENVIRONMENT VARIABLES SETUP
# ============================================

# In Render Dashboard:
# 1. Go to your service
# 2. Click "Environment" tab
# 3. Add each variable above (except comments)
# 4. Click "Save Changes"
# 5. Service will auto-deploy with new settings

# ============================================
# MEMORY OPTIMIZATION TIPS
# ============================================

# If you hit memory limits:
# 1. Reduce INACTIVITY_TIMEOUT_MINUTES to 5-8
# 2. Reduce ROOM_EXPIRY_MINUTES to 30-45
# 3. Lower MAX_MESSAGES_PER_MINUTE to 15
# 4. Implement message history limits (if not already)

# ============================================
# MONITORING
# ============================================

# Check Render logs for:
# - "ðŸ”’ Security Manager initialized" on startup
# - Memory usage warnings
# - Security events (lockouts, timeouts)
# - Error messages

# ============================================
# COST: $0/month (Free Tier)
# ============================================

# This configuration is optimized for Render's free tier
# No additional costs required
# All features work within free tier limits
